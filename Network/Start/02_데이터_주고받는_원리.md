# 프로토콜

- `프로토콜`
  - 통신 규약
  - 통신할 데이터의 구성, 데이터를 확실하게 주고받는 절차 등 각종 결정 사항과 기준이 정의되어 있음

## 통신 규약인 프로토콜

네트워크로 데이터를 주고 받으려면 송신 측과 수신 측이 *서로를 인식*하고 있어야 한다.

같은 프로토콜을 사용하면 다른 기기 간에도 통신할 수 있지만, 프로토콜이 다르면 기기가 같아도 서로 통신할 수 없다.

프로토콜은 어디까지가 주소고, 어디까지가 신호이며, 어디까지가 데이터 본체인지 약속이 필요하다.

## 프로토콜의 종류

**네트워크 계층별**로 다양한 종류의 표준과 규약이 있다.

# 네트워크 계층

## 계층별로 나누어 처리

모든 애플리케이션에서 프로토콜의 변환 처리를 수행한다면 프로그램은 복잡해지고 낭비도 많아짐

-> 네트워크를 하드웨어, 프로토콜, 애플리케이션이라는 계층(레이어)으로 나누어 처리를 분담함

## 프로토콜 스택

- 프로토콜 구조
  - 헤더 : 프로토콜 정보
  - 페이로드 : 전송하려는 데이터
- `프로토콜 스택`
  - 어떤 프로토콜의 페이로드에 다른 프로토콜의 헤더와 페이로드가 들어가 계층 구조처럼 되어 있는 상태
  - 프로토콜은 자신의 헤더를 처리하고 상위 네트워크 프로토콜에 페이로드를 전달함

> 하위 계층 프로토콜의 페이로드에 상위 계층의 헤더와 페이로드를 포함
> </br>-> 해당 프로토콜 계층은 자신의 헤더 정보만 해석한 후 페이로드를 상위 네트워크로 전달
> </br>-> 페이로드에 상위 계층의 헤더와 페이로드로 구성되어 있기 때문에 상위 네트워크의 프로토콜이 제대로 처리될 수 있음

![Alt text](image.png)

# 네트워크 모델

## OSI 참조 모델

- `OSI(Open Systems Interconnection) 참조 모델`
  - ISO(국제표준화기구)에서 제정한 네트워크 계층 모델
  - 7계층으로 나뉘어짐
  - 1977년 제정 당시 네트워크 기술을 기반으로 만들어짐 
  </br>-> *현재는 이를 그대로 구현한 네트워크나 장비가 거의 없음*
  - 프로토콜을 **계층 구조**로 만든 개념임
    - 애플리케이션 단에서 프로토콜 차이를 신경쓸 필요 없으므로 장비나 소프트웨어 개발이 용이해짐
    - 시스템을 **프로토콜 스택** 개념으로 설계 및 개발이 가능함
  - 현재도 계층을 구분하는 하나의 모델로 이용되고 있음

## TCP/IP 모델

- `TCP/IP 모델`
  - **인터넷**을 기준으로 한 네트워크의 통신 모델
  - 4계층
  - OSI 참조 모델을 기반으로 만들어졌고 각 계층이 매칭될 수 있지만, *각 계층의 구분과 역할이 모두 동일하지는 않음*
  - 오늘날 인터넷 통신에서 가장 널리 사용되는 표준 모델

![Alt text](image-1.png)

## OSI와 TCP/IP 모델의 차이

OSI는 네트워크 구조를 명확하게 설명할 수 있는 **개념적 모델**이고, TCP/IP는 실제 인터넷 통신에 사용되고 있는 **실전형 모델**이다.

OSI 모델과 완전히 맞아떨어지는 모델은 구현되지 않았지만 여전히 표준 모델로서, 네트워크 학습 자료로서 참조된다. 각 레이어는 서로 연결되어 있으며, OSI 모델에서 데이터는 계층 순서대로 이동한다.

![Alt text](image-2.png)

> 참고 : [네트워크 모델 OSI TCP/IP 차이](https://change-words.tistory.com/entry/OSI-TCPIP)

# TCP/IP

## IP 프로토콜

TCP/IP는 통신하는 패킷의 `식별자`로 IP 주소를 사용하기 때문에 보통 `TCP/IP`라고 표현한다. 하지만 프로토콜은 IP, UDP, TCP 프로토콜 등으로 분류된다.

- `IP 프로토콜`
  - UDP, TCP, HTTP 등 다른 프로토콜의 기본
  - **IP 주소(출발지 및 목적지 정보)** 를 참조하여 **데이터 본체(페이로드)** 를 *올바른 목적지에 전송하는 최소한의 절차와 규칙을 규정*
  - 페이로드에는 UDP, TCP 뿐만 아니라 상위 계층의 프로토콜 데이터가 저장됨

## UDP 프로토콜과 TCP 프로토콜

UDP와 TCP 모두 식별자로 각각 헤더에 **포트 번호**를 부여해서 IP 주소가 나타내는 사용자나 애플리케이션 종류 등을 지정한다.

- `UDP 프로토콜`
  - 포트 번호를 부여할 뿐 처리 과정 자체는 IP 프로토콜과 거의 같음
  - 수신 확인, 전송 오류 확인, 재전송 처리 등은 수행하지 않음
  - 데이터그램 : 단순히 목적지만 지정해서 전송하는 데이터
  - 신뢰성보다는 속도와 편의성을 우선시할 때 사용됨
    - 상위 애플리케이션에서 오류 검사 및 재전송 처리 등을 수행해서 기능을 보완할 수 있음

- `TCP 프로토콜`
  - 포트 번호 부여
  - 오류 검사, 재전송 처리 등 일련의 과정 규정과 세션 통신 기능 등이 있음
  - 오류 검사와 세션 통신에 필요한 정보(시퀀스 번호, 응답 확인 번호, 세션 플래그 등)가 부여됨
  - 안정적인 통신을 원할 때 사용됨

> - 식별자 : 대상을 식별하는 부호. Ex) 패킷의 목적지를 식별하는 것 -> 목적지 IP 주소
> - 세션 : 목적지로 연결을 확인하고 통신 경로를 확보 및 유지하는 것
> - 시퀀스 번호 : 큰 데이터를 여러 개의 패킷으로 분할할 때 사용하는 패킷 번호
> - 응답 확인 번호 : 시퀀스 번호가 맞는지 확인하는 번호. 자기 다음에 와야 하는 시퀀스 번호가 들어감
> - 세션 플래그 : TCP 세션의 상태를 나타내는 다양한 플래그를 의미

# IP 주소

## IP 주소의 구조

> IP 주소에는 IPv4와 IPv6라는 두 가지 버전이 있다. 43억개 밖에 표현할 수 없는 IPv4 주소가 점점 고갈되어 새로운 IP 주소 체계가 필요하게 되자 책정된 것이 IPv6다.

- `IP 주소`
  - TCP/IP 프로토콜에서 출발지나 목적지를 식별하는 식별자로 사용되는 데이터
  - 인터넷에서 사용하는 **글로벌 IP 주소**와 LAN 내에서 사용하는 **프라이빗 IP 주소**가 있음
  - 32비트로 되어있으며 8비트씩 4등분하여 8비트의 10진수로 표시할 때 점으로 구분하여 표기
    - Ex) 192.168.0.1
    - 이 때 8비트 단위를 네트워크에서는 **옥텟(octet)** 이라고 함
    - 이론상 43억 개의 주소를 사용할 수 있지만 실제로 모두가 이를 사용할 수 있는 것은 아님

## 글로벌 IP 주소와 프라이빗 IP 주소

- `글로벌 IP 주소`
  - IP 주소의 주소 공간 중 인터넷 주소로 사용할 수 있는 것
  - 이 주소를 가진 기기는 인터넷상에서 하나뿐임
- `프라이빗 IP 주소`
  - 인터넷에 직접 연결되지 않는 LAN 내부 등의 주소 공간에서 사용하는 IP 주소
  - LAN마다 중복되지 않게 관리하면 다른 사무실이나 LAN에서 같은 IP를 사용할 수 있음

> 인터넷에서 개인을 식별할 때는 IP 주소를 이용한다. 그러나 인터넷상의 IP 주소는 단지 네트워크에 연결된 라우터나 서버, 일부 컴퓨터를 가리킬 뿐이다. 때문에 IP 주소 정보로 발신자를 식별하려면 라우터나 서버의 로그 정보 등의 다른 정보가 필요하다.

# IPv4/IPv6

v4와 v6 사이에 프로토콜 호환성은 없고, 현재 인터넷에는 이 두 포로토콜이 혼재되어 있다.

## IPv4와 IPv6의 차이점

IPv6는 2의 128제곱이라는 방대한 주소 공간을 갖고 있어 IP 주소가 고갈될 염려는 거의 없다. 다만 IPv4와 IPv6 간에는 호환성이 없으므로 IPv6로 인터넷에 연결하려면 IPv6와 호환되는 앱이나 서비스를 사용해야 한다.

다만 주류로 사용되는 OS나 웹브라우저, DNS에서는 IPv6을 지원하므로 사용자가 IPv4와 IPv6를 구분할 필요는 없다.

## IPv6의 특징

- 특징
  - 프로토콜 수준에서 암호화 통신이 규정되어 있음
  - MAC 주소를 이용하여 IPv6 주소를 자동으로 생성할 수 있고, 2계층을 포함한 설정 자동화가 가능
  - 헤더가 IPv4보다 단순해서 처리가 간단
  - 계층 구조가 엄격하여 라우팅 효율이 좋음

현재 IPv4와 IPv6 패킷은 인터넷상에 혼재되어 있고, IPv4가 금지되어 있는 것은 아니므로 전 세계 서버 및 웹 서비스 등은 *IPv4를 기반으로 동작*하고 있다.